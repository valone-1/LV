"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}$(document).ready(function(){loadcarts()});var lunbo=function(){function t(e){_classCallCheck(this,t),this.sel=e,this.el=document.querySelector(this.sel),this.pageNum=0,this.pageLis=this.el.querySelectorAll(".page li"),this.rightbtn=this.el.querySelector(".rightbtn"),this.leftbtn=this.el.querySelector(".leftbtn"),this.oLis=this.el.querySelectorAll(".item li"),this.pageLisEvent(),this.autoplay(),this.btnEvents()}return _createClass(t,[{key:"pageLisEvent",value:function(){for(var e=0;e<this.pageLis.length;e++)this.pageLis[this.pageNum].style.display="none";this.pageLis[this.pageNum].style.display="block"}},{key:"autoplay",value:function(){var e=this;this.timer=setInterval(function(){e.next()},2500),this.el.onmouseenter=function(){e.el,clearInterval(e.timer)},this.el.onmouseleave=function(){e.timer=setInterval(function(){e.next()},2500)}}},{key:"btnEvents",value:function(){var e=this;this.rightbtn.onclick=function(){e.next()},this.leftbtn.onclick=function(){e.prev()}}},{key:"prev",value:function(){var e=this;animate(e.oLis[e.pageNum],{opacity:0}),e.pageNum--,-1==e.pageNum&&(e.pageNum=1),animate(e.oLis[e.pageNum],{opacity:1}),this.pageLisEvent()}},{key:"next",value:function(){var e=this;animate(e.oLis[e.pageNum],{opacity:0}),e.pageNum++,2==e.pageNum&&(e.pageNum=0),animate(e.oLis[e.pageNum],{opacity:1}),this.pageLisEvent()}}]),t}(),r=new lunbo(".box"),uid=JSON.parse(localStorage.getItem("id")),token=JSON.parse(localStorage.getItem("token")),username=JSON.parse(localStorage.getItem("username"));function loadcarts(){if(uid){$.get("http://jx.xuzhixiang.top/ap/api/cart-list.php",{id:uid}).then(function(e){console.log(e.data);var n=e.data;$("#number").html(n.length);var i="";$(n).each(function(e,t){i+='\n                                <li>\n                                    <a href="goods-content.html?pid='.concat(n[e].pid,'">\n\n                                        <img src="').concat(n[e].pimg,'" alt="">\n                                        <span class="goodsname">').concat(n[e].pname,'</span>\n                                        <span class="goodspprice">').concat(n[e].pprice,"</span>\n\n                                    </a>\n                                </li>\n                            ")}),$(".cart-ul").html(i);var o=0;$(".goodspprice").each(function(e,t){console.log(t),o+=parseInt($(".goodspprice").eq(e).html())}),$(".money").html($(".money").html()+o)})}else $(".gouwuche").click(function(){alert("请先登录"),location.href="login.html"})}console.log(username),$(".login-lv").click(function(){uid?($("#personal li").eq(0).html("用户"+username),$("#personal").toggle(),$("#loginout").click(function(){1==confirm("您确定要退出吗")&&(localStorage.removeItem("id"),localStorage.removeItem("username"),localStorage.removeItem("token"),this.href="login.html")})):(alert("请登录"),location.href="login.html")}),$("#cart-clo").click(function(){$(".carts").css({display:"none"})}),uid?($(".gouwuche").click(function(){$(".carts").css({display:"block"});$.get("http://jx.xuzhixiang.top/ap/api/cart-list.php",{id:uid}).then(function(e){var n=e.data;$("#number").html(n.length),console.log(n.length);var i="";$(n).each(function(e,t){i+='\n                    <li>\n                        <a href="goods-content.html?pid='.concat(n[e].pid,'">\n                        \n                            <img src="').concat(n[e].pimg,'" alt="">\n                            <span class="goodsname">').concat(n[e].pname,'</span>\n                            <span class="goodspprice">￥').concat(n[e].pprice,"</span>\n                        \n                        </a>\n                    </li>\n                ")}),$(".cart-ul").html(i)})}),$("#cart-clo").click(function(){$(".carts").css({display:"none"})}),$(".item").click(function(){location.href="goods-list.html"})):($(".gouwuche").click(function(){confirm("请登录以查看购物车")&&(location.href="login.html")}),$(".item").click(function(){confirm("请登录以查看更多")?location.href="login.html":location.reload()}),$(".c-goods").click(function(){confirm("请登录以查看更多")&&(this.href="login.html")}),$(".goods-item").click(function(){confirm("请登录以查看更多")&&(this.href="login.html")}));